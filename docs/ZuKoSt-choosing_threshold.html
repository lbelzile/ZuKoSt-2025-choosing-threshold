<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-81b5c3e63835cfde897ecd3d35a35a41.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.3">

  <meta name="author" content="Léo Belzile, HEC Montréal">
  <title>Choosing the threshold in extreme value analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-78bf437ef0cff5db7e5240731518873b.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  .v-center-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 90%;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#002855" class="quarto-title-block center">
  <h1 class="title">Choosing the threshold in extreme value analysis</h1>
  <p class="subtitle">ZüKoSt: Seminar on Applied Statistics</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Léo Belzile, HEC Montréal 
</div>
</div>
</div>

  <p class="date">Thursday, Nov 20, 2025</p>
</section>
<section>
<section id="motivation" class="title-slide slide level1 white center" data-background-color="#002855">
<h1>Motivation</h1>

</section>
<section id="typical-research-question" class="slide level2">
<h2>Typical research question</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div style="font-size: 90%;">
<p>Consider daily total rainfall data from Padova for July–September over the period 1878–2016, yielding <span class="math inline">\(n=3311\)</span> data points in excess of 2mm <span class="citation" data-cites="Marani.Zanetti:2015">(<a href="#/references" role="doc-biblioref" onclick="">Marani and Zanetti 2015</a>)</span>.</p>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-2-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p>Research question: what is the expected maximum rainfall episode over a 50 year period?</p>
<aside class="notes">
<p>Typically, records (time series) are short.</p>
<p>The risk quantities of interest cannot reliably be estimated empirically.</p>
<p>We need a mathematically justified framework for extrapolation.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="peaks-over-threshold" class="slide level2">
<h2>Peaks over threshold</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Extremes from a stationary time series may be modelled by considering only the <span class="math inline">\(n_u\)</span> observations that exceed a threshold <span class="math inline">\(u\)</span>.</p>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-3-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p>The threshold <span class="math inline">\(u\)</span> is a fixed location parameter determined by the user.</p>
</section>
<section id="mathematical-framework" class="slide level2">
<h2>Mathematical framework</h2>
<p>Under mild conditions, there exists a positive function <span class="math inline">\(\sigma_u\)</span> such that, as <span class="math inline">\(u\)</span> approaches the upper support point of <span class="math inline">\(Y\)</span>, <span class="math display">\[\begin{equation}\label{eq1}
\Pr\{(Y-u)/\sigma_u&gt;y\mid Y&gt;u\} \to (1 + \xi y)_+^{-1/\xi}, \quad y&gt;0,
\end{equation}\]</span> uniformly in <span class="math inline">\(y\)</span>.</p>
<p>Exceedances <span class="math inline">\(X = Y-u &gt;0\)</span> over a sufficiently high threshold <span class="math inline">\(u\)</span> are thus approximately <strong>generalized Pareto</strong> distributed. We write <span class="math inline">\(X \sim \textsf{GP}(\sigma_u, \xi).\)</span></p>
<!-- \begin{align*} -->
<!-- \Pr(X\leq x)\approx \begin{cases} 1 - (1 + \xi x/\sigma_u)_+^{-1/\xi}, & \xi\neq 0,\\ 1-\exp(-x/\sigma_u),& \xi=0, \end{cases} \quad x> 0. -->
<!-- \end{align*} -->
</section>
<section id="risk-measures-and-extrapolation" class="slide level2">
<h2>Risk measures and extrapolation</h2>
<p><span class="math display">\[\begin{align*}
\Pr(Y &gt; v) &amp;= \Pr(Y &gt; v \mid Y&gt;u)\Pr(Y &gt; u)
\\ &amp; \approx \{1 + \xi (v-u)/\sigma_u\}_+^{-1/\xi} \zeta_u
\end{align*}\]</span></p>
<div style="font-size: 80%;">
<p>There are three parameters:</p>
<ul>
<li>the scale <span class="math inline">\(\sigma_u\)</span> (threshold dependent),</li>
<li>the shape <span class="math inline">\(\xi\)</span>,</li>
<li>the probability of exceedance <span class="math inline">\(\zeta_u = \Pr(Y &gt; u)\)</span>.</li>
</ul>
</div>
</section>
<section id="fixed-or-random-threshold" class="slide level2">
<h2>Fixed or random threshold?</h2>
<ul>
<li><strong>random</strong>: <span class="math inline">\(n_u\)</span> is fixed and <span class="math inline">\(u\)</span> is an order statistic (sample value) <span class="math inline">\(Y_{(n-n_u)}\)</span>.</li>
<li><strong>fixed</strong>: if <span class="math inline">\(u\)</span> is a fixed quantity (20 mm of rain), then the probability of exceedance <span class="math inline">\(\zeta_u = \Pr(Y &gt; u)\)</span> is random.</li>
</ul>
<p>Write <span class="math inline">\(\mathcal{U} = u_1 \le \cdots \le u_K\)</span> for the set of thresholds under consideration.</p>
<aside class="notes">
<p>Uncertainty of <span class="math inline">\(\zeta_u\)</span> often ignored, but the latter is smaller. The binomial component is conditionally independent of the generalized Pareto part.</p>
<p>The partial nesting induces dependence, but since samples have different numbers of exceedances, model comparison is difficult.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="risk-measures" class="slide level2">
<h2>Risk measures</h2>
<p>Let <span class="math inline">\(G(x; \sigma_u, \xi)\)</span> denotes the generalized Pareto distribution function above <span class="math inline">\(u\)</span>.</p>
<p>If there are on average <span class="math inline">\(n_y\)</span> observations per year, then the <span class="math inline">\(N\)</span> year maximum distribution above <span class="math inline">\(u\)</span> is approximately <span class="math display">\[G^{Nn_y\zeta_u}(x; \sigma_u, \xi).\]</span></p>
<p>We can also consider the <span class="math inline">\(N\)</span> year return level, the quantile of an annual maximum exceeded with probability <span class="math inline">\(1/N\)</span> in any given year, <span class="math inline">\(G^{-1}\{1-1/(\zeta_u n_y N)\}.\)</span></p>
</section>
<section id="expected-value-of-50-year-maximum" class="slide level2">
<h2>Expected value of 50-year maximum</h2>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/fig-post-1.png" style="width:80.0%" class="r-stretch quarto-figure-center" id="fig-post"><p class="caption">
Figure&nbsp;1: Bayesian and frequentist inference based on a threshold of <span class="math inline">\(u=30\)</span>mm.
</p></section>
<section id="guided-recipe" class="slide level2">
<h2>Guided recipe</h2>
<p>In the simplest applications:</p>
<ol type="1">
<li><strong>we choose a high threshold <span class="math inline">\(u\)</span> or equivalently <span class="math inline">\(n_u\)</span>.</strong></li>
<li>we fit the limiting generalized Pareto distribution with scale <span class="math inline">\(\sigma_u\)</span> and shape <span class="math inline">\(\xi\)</span> to exceedances <span class="math inline">\(Y-u\)</span> above the threshold <span class="math inline">\(u\)</span>.</li>
<li>we use the resulting model for extrapolation beyond <span class="math inline">\(u\)</span>.</li>
</ol>
</section></section>
<section>
<section id="how-to-choose-the-threshold" class="title-slide slide level1 white center" data-background-color="#002855">
<h1>How to choose the threshold?</h1>

</section>
<section id="objective" class="slide level2">
<h2>Objective</h2>
<p>We provide an extensive review of threshold selection mechanisms for peaks over threshold analysis, including</p>
<ul>
<li>visual diagnostics,</li>
<li>extended generalized Pareto models,</li>
<li>goodness-of-fit tests,</li>
<li>semiparametric methods based on Hill’s estimator.</li>
</ul>
<p>We also perform simulation experiments to assess their performances over a range of distribution, with rounded and serially correlated data.</p>
</section>
<section id="why-another-survey-paper" class="slide level2">
<h2>Why another survey paper?</h2>
<p>There are earlier reviews of the topic, but the literature keeps increasing…</p>
<ul>
<li>The most comprehensive reviews are <span class="citation" data-cites="Scarrott.MacDonald:2012">Scarrott and MacDonald (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span>, <span class="citation" data-cites="Caeiro.Gomes:2016">Caeiro and Gomes (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> and <span class="citation" data-cites="Langousis:2016">Langousis et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span>.</li>
<li>Selective numerical comparisons in <span class="citation" data-cites="Gomes.Oliveira:2001">Gomes and Oliveira (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span>, <span class="citation" data-cites="Schneider:2021">Schneider, Krajina, and Krivobokova (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> and <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span>, among others.</li>
</ul>
<p>More than 40 methods implemented and compared through simulations.</p>
</section>
<section id="hill-estimator" class="slide level2">
<h2>Hill estimator</h2>
<p>For a random sample <span class="math inline">\(Y_{(1)} \leq \cdots \leq Y_{(n)},\)</span> the <span class="citation" data-cites="Hill:1975">Hill (<a href="#/references" role="doc-biblioref" onclick="">1975</a>)</span> estimator for <span class="math inline">\(\xi&gt;0\)</span> is <span class="math display">\[H_{n,n_u} = \frac{1}{n_u} \sum_{i=n-n_u+1}^{n} \log Y_{(i)} - \log Y_{(n-n_u)}.\]</span> The <span class="citation" data-cites="Weissman:1978">Weissman (<a href="#/references" role="doc-biblioref" onclick="">1978</a>)</span> estimator of the quantile at level <span class="math inline">\(1-p\)</span> is <span class="math display">\[Q_{n_u}(1-p) = Y_{(n-n_u)}\{n_u/(pn)\}^{H_{n,n_u}}.\]</span></p>
</section>
<section id="maximum-likelihood-estimator" class="slide level2">
<h2>Maximum likelihood estimator</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Treat exceedances above <span class="math inline">\(u\)</span> as an exact sample from generalized Pareto, estimate parameters using <span class="citation" data-cites="Grimshaw:1993">Grimshaw (<a href="#/references" role="doc-biblioref" onclick="">1993</a>)</span> algorithm.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size: 80%;">
<ul>
<li>Works for <span class="math inline">\(\xi \in \mathbb{R}\)</span>.</li>
<li>Readily extends to different sample schemes (censoring, truncation, dependence on covariates)</li>
<li>Coherent framework for testing and extrapolation</li>
<li>Larger variance than Hill estimator for <span class="math inline">\(\xi\)</span>.</li>
</ul>
</div>
</div></div>
<aside class="notes">
<p>Asymptotic normality depends on second-order conditions, which are distribution specific.</p>
<p>The variance of the MLE of <span class="math inline">\(\xi\)</span> is <span class="math inline">\((1+\xi)^2,\)</span> versus <span class="math inline">\(\xi^2\)</span> for the Hill estimator.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">


<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/fig-shapequant-1.png" style="width:90.0%" class="r-stretch quarto-figure-center" id="fig-shapequant"><p class="caption">
Figure&nbsp;2: Estimates of shape (left) and 100-year return level (right) as a function <span class="math inline">\(n_u\)</span> corresponding to threshold <span class="math inline">\(X_{(n-n_u)}.\)</span>
</p></section>
<section id="bias-and-variance-trade-off" class="slide level2">
<h2>Bias and variance trade-off</h2>
<ul>
<li>The quality of the generalized Pareto approximation improves as <span class="math inline">\(u\)</span> converges to the endpoint. Taking <span class="math inline">\(u\)</span> too low increases the risk of biased extrapolation.</li>
<li>Taking <span class="math inline">\(u\)</span> too high will mean that the number of exceedances <span class="math inline">\(n_u\)</span> is small (high uncertainty of estimators of <span class="math inline">\(\sigma_u\)</span> and <span class="math inline">\(\xi\)</span>). We need enough data (at least <span class="math inline">\(n_u=20\)</span>, say).</li>
</ul>
<aside class="notes">
<p>The likelihood for the whole data includes a binomial component for <span class="math inline">\(\zeta_u = \Pr(Y &gt; u)\)</span> (binomial). This parameter is orthogonal to <span class="math inline">\((\sigma_u, \xi).\)</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="properties-underlying-threshold-selection" class="title-slide slide level1 white center" data-background-color="#002855">
<h1>Properties underlying threshold selection</h1>

</section>
<section id="threshold-stability-and-extrapolation" class="slide level2">
<h2>Threshold stability and extrapolation</h2>
<p>If <span class="math inline">\(X\sim \mathsf{GP}(\sigma,\xi),\)</span> then for any <span class="math inline">\(v&gt;0\)</span> such that <span class="math inline">\(\sigma_v=\sigma+ \xi v &gt; 0\)</span>, we have <span class="math display">\[\begin{align*}
X-v \mid X&gt;v \sim \mathsf{GP}(\sigma_v, \xi)
\end{align*}\]</span> This property is termed <strong>threshold stability</strong>. The shape is in principle constant.</p>
<p>The mean excess is also linear in <span class="math inline">\(v\)</span>: <span class="math display">\[\begin{align}
e(v) = \mathrm{E}(X - v \mid X&gt;v) = \frac{\sigma}{1-\xi} + \frac{\xi}{1-\xi} v, \quad v\geq 0.   \label{eq:mrl}
\end{align}\]</span></p>
</section>
<section id="consistency" class="slide level2">
<h2>Consistency</h2>
<p>We work under ‘’domain of attraction’’ condition, meaning that usual asymptotics are only valid if the threshold increases with the sample size.</p>
<p>For consistency, we need an intermediate sequence <span class="math inline">\(n_u/n \to 0\)</span>, but <span class="math inline">\(n_u, n \to \infty\)</span>, e.g., <span class="math inline">\(n_u = \lceil n- n^q\rceil\)</span> for <span class="math inline">\(q \in (0,1)\)</span>, with <span class="math inline">\(q=0.995\)</span> or <span class="math inline">\(q=0.999.\)</span></p>
<p>Simple rules such as using a fixed proportion of the data by setting <span class="math inline">\(n_u\approx np\)</span> for some fixed <span class="math inline">\(p\)</span>, do not satisfy this.</p>
</section>
<section id="second-order-regular-variation" class="slide level2">
<h2>Second-order regular variation</h2>
<div style="font-size: 80%;">
<p>Suppose that its distribution function <span class="math inline">\(F\)</span> has two continuous derivatives and is continuous at its endpoint.</p>
<p>Define</p>
<ul>
<li><span class="math inline">\(\xi\)</span> denote the limiting shape parameter for the generalized Pareto approximation.</li>
<li><span class="math inline">\(u_t=F^{-1}(1-1/t)\)</span> be the <span class="math inline">\(1-1/t\)</span> quantile of <span class="math inline">\(F,\)</span></li>
<li><span class="math inline">\(\sigma_t = r(u_t),\)</span> where <span class="math inline">\(r(t) = \{1-F(t)\}/f(t)\)</span> is the reciprocal hazard function,</li>
<li><span class="math inline">\(\xi_t = r'(u_t)\)</span> is the penultimate approximation to the shape.</li>
<li><span class="math inline">\(A(t) =\xi_t - \xi,\)</span> assuming <span class="math inline">\(u_t\)</span> is twice differentiable and <span class="math inline">\(u_t'\)</span> is eventually positive.</li>
</ul>
</div>
</section>
<section id="asymptotic-normality" class="slide level2">
<h2>Asymptotic normality</h2>
<p>Under a second order regular variation assumption with <span class="math inline">\(\lim_{n_u \to \infty} \sqrt{n_u}A(n/n_u) = \lambda\in \mathbb{R}\)</span>, subject to which <span class="citation" data-cites="deHaan.Ferreira:2006">(Theorem 3.2.5 of <a href="#/references" role="doc-biblioref" onclick="">de Haan and Ferreira 2006</a>)</span> <span class="math display">\[\begin{align*}
n_u^{1/2}(H_{n,n_u} - \xi) \to \mathsf{normal}\{\lambda/(1-\rho), \xi^2\}, \quad \rho \leq 0.
\end{align*}\]</span></p>
<p>Similar results hold for maximum likelihood estimators.</p>
<aside class="notes">
<p>The asymptotic bias, which is unobtainable in finite samples, is dictated by the rate at which the number of extreme observations grows relative to the total sample size, but also by the function <span class="math inline">\(A(t)\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="minimizing-mean-squared-error" class="slide level2">
<h2>Minimizing mean squared error</h2>
<div style="font-size: 90%;">
<p>Many heavy-tailed distributions fall within the <span class="citation" data-cites="Hall.Welsh:1985">Hall and Welsh (<a href="#/references" role="doc-biblioref" onclick="">1985</a>)</span> class have <span class="math inline">\(A(t) = \beta t^\rho\)</span> for <span class="math inline">\(\beta \neq 0\)</span> with <span class="math inline">\(\rho &lt; 0.\)</span></p>
<p>The asymptotic mean squared error of Hill’s estimator is <span class="math display">\[\mathsf{AMSE}(H_{n,n_u}) = \xi^2/n_u + A^2(n/n_u)/(1-\rho)^2,\]</span> which is minimized when <span class="math display">\[\begin{align}
n_u = \left\lfloor \frac{(1-\rho)^2 n^{-2\rho}}{-2\rho \beta^2}\right\rfloor^{\frac{1}{1-2\rho}}.
\end{align}\]</span></p>
</div>
<aside class="notes">
<p>Estimation of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\rho\)</span> is difficult and typically far too noisy to be useful. More stable methods are obtained by fixing <span class="math inline">\(\rho\)</span> to a negative value, or bypassing its estimation completely, as in <span class="citation" data-cites="Wager:2014">Wager (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="penultimate-approximations" class="slide level2 smaller">
<h2>Penultimate approximations</h2>
<p><span class="citation" data-cites="smith_1987">Smith (<a href="#/references" role="doc-biblioref" onclick="">1987</a>)</span> show that a better approximation to the tail is obtained by letting the shape vary with <span class="math inline">\(u\)</span>, taking <span class="math inline">\(\mathsf{GPD}(\sigma_u, \xi_u)\)</span>, where <span class="math inline">\(\xi_u = r'(u).\)</span>.</p>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-6-1.png" style="width:80.0%" class="r-stretch"><aside class="notes">
<p>Statistical and mathematical approximations to the limits may differ substantially.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="point-process-formulation" class="slide level2 smaller">
<h2>Point process formulation</h2>
<p>The generalized Pareto distribution can be derived from a limiting Poisson process <span class="math inline">\({\mathcal P}\)</span> under which rare events occur in the <span class="math inline">\((t,y)\)</span>-plane with measure <span class="math display">\[\begin{align*}
\Lambda[(t',t)\times[u,\infty)] = (t_2-t_1)\{1+\xi(u-\eta)/\sigma\}^{-1/\xi}_+, \qquad \eta \in \mathbb{R}, \sigma &gt; 0.
\end{align*}\]</span></p>
<p>The vertical coordinates of <span class="math inline">\({\mathcal P}\)</span> can be generated as <span class="math display">\[\begin{align*}
\eta + \frac{\sigma}{\xi}\Bigg\{\Bigg(\sum_{j=1}^r E_j\Bigg)^{-\xi} - 1\Bigg\}, \quad r=1,2,\ldots;
\end{align*}\]</span> where the <span class="math inline">\(E_j\)</span> are independent exponential random variables.</p>
<p>The choice of threshold then amounts to choosing the highest value for which the transformed observations are consistent with a unit-rate Poisson process.</p>
</section>
<section id="rényi-representation" class="slide level2">
<h2>Rényi representation</h2>
<p>Threshold-stability and the Markov nature of order statistics <span class="math inline">\(X_{(1)}\leq\cdots\leq X_{(n)}\)</span> of a simple random sample drawn from <span class="math inline">\(\mathsf{GP}(\sigma,\xi)\)</span> imply that</p>
<ul>
<li><span class="math inline">\(X_{(1)} \sim \mathsf{GP}(\sigma/n,\xi/n)\)</span></li>
<li>the increments <span class="math inline">\(X_{(j)}-X_{(j-1)} \mid X_{(j-1)}=x_{(j-1)}\)</span> have <span class="math inline">\(\mathsf{GP}\{\sigma_j, \xi/(n+1-j)\}\)</span> distributions, for <span class="math inline">\(j=2, \ldots, n\)</span>, and are independent of the lower order statistics.</li>
</ul>
<div style="font-size: 60%;">
<p><span class="citation" data-cites="Hill:1975">Hill (<a href="#/references" role="doc-biblioref" onclick="">1975</a>)</span> proposes testing for exponentiality, but the departure is very gradual <span class="citation" data-cites="Hall.Welsh:1985">(<a href="#/references" role="doc-biblioref" onclick="">Hall and Welsh 1985</a>)</span>, so too small thresholds are returned.</p>
</div>
</section></section>
<section>
<section id="selection-methods" class="title-slide slide level1 white center" data-background-color="#002855">
<h1>Selection methods</h1>

</section>
<section id="common-challenges" class="slide level2">
<h2>Common challenges</h2>
<div style="font-size: 80%;">
<p>Conditional model: only consider data above the threshold.</p>
<!-- Consider candidate thresholds $\mathcal{U}$, either fixed $u_1 < \cdots < u_K$ or random. -->
<p>Problems:</p>
<ul>
<li>Sequential analysis: dependence between estimates, test statistics, <span class="math inline">\(P\)</span>-values due to sample overlap.</li>
<li>Non-nested models (as the sample changes with the threshold).</li>
<li>Multiple testing problem.</li>
</ul>
</div>
</section>
<section id="mean-residual-life-plot" class="slide level2">
<h2>Mean residual life plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 80%;">
<p>Mean residual plot <span class="citation" data-cites="Davison.Smith:1990">(<a href="#/references" role="doc-biblioref" onclick="">Davison and Smith 1990</a>)</span>, which graphs the empirical mean excesses <span class="math inline">\(e(u)\)</span> against thresholds <span class="math inline">\(u \in \mathcal{U}.\)</span></p>
<p>Common practice is to find a region above which the slope looks <strong>linear</strong>.</p>
<p>Automation proposed by <span class="citation" data-cites="Langousis:2016">Langousis et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> based on weighted regression.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-7-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="threshold-stability-plots" class="slide level2">
<h2>Threshold stability plots</h2>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"><aside class="notes">
<p>Difficulty to automate selection, pointwise confidence intervals, and the plots say nothing about goodness-of-fit!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="caveats-of-graphical-diagnostics" class="slide level2">
<h2>Caveats of graphical diagnostics</h2>
<ul>
<li>Difficulty in automating selection (need visual inspection); proposals in <span class="citation" data-cites="Langousis:2016">Langousis et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> or <span class="citation" data-cites="Danielsson:2019">Danielsson et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span>, but both fall short.</li>
<li>Problems: pointwise confidence intervals.</li>
<li>Underlying assumptions affected by penultimate effects.</li>
<li>The plots say nothing about goodness-of-fit!</li>
</ul>
<!-- ## Penultimate effects - quantiles -->
<!-- ```{r} -->
<!-- #| eval: true -->
<!-- #| echo: false -->
<!-- #| fig-align: 'center' -->
<!-- #| out-width: '100%' -->
<!-- knitr::include_graphics("figures/Fig1.png") -->
<!-- ``` -->
<!-- ::: {style="font-size: 60%;"} -->
<!-- Conditional quantiles above threshold, rescaled. 45$^{\circ}$ line shows limiting exponential with true conditional quantile (black), MLE based on 1M exceedances (dashed red) and Smith penultimate approximation (green). -->
<!-- ::: -->
</section>
<section id="extended-generalized-pareto-models" class="slide level2">
<h2>Extended generalized Pareto models</h2>
<div style="font-size: 80%;">
<p>Embed generalized Pareto <span class="math inline">\(F(x;\sigma,\xi)\)</span> in a more flexible model using a continuous distribution function <span class="math inline">\(G_\kappa\)</span> on <span class="math inline">\([0,1]\)</span>. The EGP<span class="math inline">\((\sigma,\xi, G_\kappa)\)</span> distribution function is then <span class="math display">\[\begin{align*}
\Pr(X\leq x) = G_\kappa\{ F(x;\sigma,\xi)\}.                     \end{align*}\]</span> Choose <span class="math inline">\(G\)</span> to keep the tail properties. See the chapter of <span class="citation" data-cites="Naveau:2025">Naveau (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> for a recent review.</p>
<ul>
<li><span class="citation" data-cites="Papastathopoulos.Tawn:2013">Papastathopoulos and Tawn (<a href="#/references" role="doc-biblioref" onclick="">2013</a>)</span>: models imply the density at the origin is zero.</li>
<li><span class="citation" data-cites="Gamet.Jalbert:2022">Gamet and Jalbert (<a href="#/references" role="doc-biblioref" onclick="">2022</a>)</span> propose two models, but one leads to non-regular asymptotics (restriction on boundary of the parameter space).</li>
<li><span class="citation" data-cites="Naveau:2016">Naveau et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> additional models with two parameters.</li>
</ul>
</div>
</section>
<section id="piecewise-generalized-pareto-model" class="slide level2">
<h2>Piecewise generalized Pareto model</h2>
<p><span class="citation" data-cites="Northrop.Coleman:2014">Northrop and Coleman (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> specify a truncated generalized Pareto distribution with shape <span class="math inline">\(\xi_i\)</span> in interval <span class="math inline">\([u_{i}, u_{i+1})\)</span>, and continuity constraints for the scale parameters.</p>
<p>The model has parameters <span class="math inline">\(\xi_1, \ldots, \xi_K, \sigma,\)</span> and reduces to the generalized Pareto above <span class="math inline">\(u_k\)</span> if <span class="math inline">\(\xi_k = \cdots = \xi_K\)</span>.</p>
<p>The power of the test is sensitive to the choice of the largest threshold <span class="math inline">\(u_K\)</span>.</p>
<aside class="notes">
<p>The model is inspired by previous work of Wadsworth and Tawn, and inspired by the penultimate approximations.</p>
<p>The model is very hard to fit, so use score tests.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="extended-generalized-pareto-models-for-padova-data" class="slide level2">
<h2>Extended generalized Pareto models for Padova data</h2>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/fig-extended-1.png" width="960" class="r-stretch quarto-figure-center" id="fig-extended"><p class="caption">
Figure&nbsp;3: <span class="citation" data-cites="Northrop.Coleman:2014">Northrop and Coleman (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> score test (left) and confidence intervals for <span class="math inline">\(\kappa=1\)</span> for EGP distribution (right)
</p></section>
<section id="extended-generalized-pareto-models-1" class="slide level2">
<h2>Extended generalized Pareto models</h2>
<p>Test for restriction to generalized Pareto sub-model using likelihood ratio or score tests.</p>
<ul>
<li>Could allow for a bit more data to be included, at the expense of additional parameters to estimate (and potentially more variability).</li>
<li>Same problems as parameter stability plots (sequential tests, overlapping data).</li>
</ul>
</section>
<section id="splicing-models" class="slide level2">
<h2>Splicing models</h2>
<div style="font-size: 80%;">
<p>Glue a distribution for the bulk with one for the tail using a mixture of disjoint components below <span class="math inline">\(u\)</span> (bulk) and above <span class="math inline">\(u\)</span> (generalized Pareto).</p>
<p>See <span class="citation" data-cites="Scarrott.MacDonald:2012">Scarrott and MacDonald (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span> and <span class="citation" data-cites="Hu.Scarrott:2018">Hu and Scarrott (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span> for reviews.</p>
<p>A ‘’parametrized tail fraction’’ model uses a mixture of truncated distribution <span class="math inline">\(H\)</span> below and generalized Pareto above <span class="math inline">\(u\)</span>, with mixing probability <span class="math inline">\(\zeta_u\)</span>, <span class="math display">\[\begin{align*}
F(x; \boldsymbol{\theta}) =
\begin{cases}
(1-\zeta_u){H(x; \boldsymbol{\theta})}/{H(u; \boldsymbol{\theta})} ,&amp; x \leq u, \\
(1-\zeta_u) + \zeta_u\left\{1-\left(1+\xi\frac{x-u}{\sigma}\right)^{-1/\xi}\right\} ,&amp; x &gt; u.
\end{cases}
\end{align*}\]</span></p>
</div>
</section>
<section id="splicing-models-for-padova-data" class="slide level2">
<h2>Splicing models for Padova data</h2>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="drawback-and-advantages-of-splicing-models" class="slide level2">
<h2>Drawback and advantages of splicing models</h2>
<p>Model all of the data, but need flexible models for bulk (kernel density mixtures). The choice of <span class="math inline">\(u\)</span> still critical.</p>
<ul>
<li>If <span class="math inline">\(u\)</span> is a parameter, the profile likelihood for threshold <span class="math inline">\(u\)</span> needs not be monotone.</li>
<li>Fit of the tail may be driven by bulk (sample contamination)</li>
<li>Sharp discontinuity at <span class="math inline">\(u\)</span>, continuity constraints or random threshold <span class="citation" data-cites="doNascimento.Gamerman.Lopes:2012">(<a href="#/references" role="doc-biblioref" onclick="">Nascimento, Gamerman, and Lopes 2012</a>)</span> alleviate this somewhat.</li>
</ul>
</section>
<section id="goodness-of-fit-measures" class="slide level2">
<h2>Goodness-of-fit measures</h2>
<div style="font-size: 90%;">
<ol type="1">
<li>Fit a generalized Pareto distribution at each candidate threshold.</li>
<li>Compute either
<ul>
<li>a suitable statistic which indicates departure from the postulated distribution.</li>
<li>a measure of discrepancy between empirical distribution of exceedances above <span class="math inline">\(u\)</span> and generalized Pareto model (via Kolmogorov–Smirnov, Cramér–von Mises, etc.)</li>
</ul></li>
<li>Perform tests sequentially until rejection, or select the “best” threshold according to the criterion.</li>
</ol>
</div>
</section>
<section id="some-proposals" class="slide level2">
<h2>Some proposals</h2>
<ul>
<li>Idea dates back to <span class="citation" data-cites="Pickands:1975">Pickands (<a href="#/references" role="doc-biblioref" onclick="">1975</a>)</span>.</li>
<li><span class="citation" data-cites="Choulakian.Stephens:2001">Choulakian and Stephens (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span>, <span class="citation" data-cites="Thompson:2009">Thompson et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span>, <span class="citation" data-cites="Bader.Yan.Zhang:2018">Bader, Yan, and Zhang (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span> (using ForwardStop).</li>
<li>Recent proposals using <span class="math inline">\(L\)</span>-moment estimators including <span class="citation" data-cites="Kiran.Srinivas:2021">Kiran and Srinivas (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, <span class="citation" data-cites="Solari:2017">Solari et al. (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span>, <span class="citation" data-cites="SilvaLomba.FragaAlves:2020">Silva Lomba and Fraga Alves (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>.</li>
</ul>
<div style="font-size: 70%;">
<p>Note: goodness-of-fit tests null distributions require adjustment for rounded values (estimate null via Monte Carlo).</p>
</div>
</section>
<section id="metric-based-adjustment" class="slide level2">
<h2>Metric-based adjustment</h2>
<div style="font-size: 70%;">
<p>The visual assessment of model quality often uses a quantile-quantile plot. <span class="citation" data-cites="Varty.Tawn:2021">Varty et al. (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span>, <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> and <span class="citation" data-cites="Collings:2025">Collings et al. (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> propose comparing Q-Q plot positions with expected ones, accounting for estimation uncertainty. The recommended metric is the mean absolute error between quantiles. The selected threshold is the one that minimizes the metric.</p>
<ul>
<li>obtain maximum likelihood estimates above <span class="math inline">\(u,\)</span> say <span class="math inline">\(\widehat{\sigma}_u, \widehat{\xi}_u.\)</span></li>
<li>fix a grid <span class="math inline">\(\mathcal{P} = p_1 \leq \cdots \leq p_m\)</span> of probability levels at which to evaluate the fit.</li>
<li>generate <span class="math inline">\(B\)</span> bootstrap samples of exceedances and fit the generalized Pareto model to get <span class="math inline">\(\widehat{\sigma}^{(b)}_u, \widehat{\xi}^{(b)}_u\)</span> for <span class="math inline">\(b=1, \ldots, B.\)</span></li>
<li>obtain the <span class="math inline">\(x\)</span>-axis positions using the generalized Pareto quantile function with parameters <span class="math inline">\(\widehat{\sigma}^{(b)}_u, \widehat{\xi}^{(b)}_u.\)</span></li>
<li>obtain the <span class="math inline">\(y\)</span>-axis positions from the empirical quantile function evaluated at <span class="math inline">\(\mathcal{P}.\)</span></li>
<li>compute the average metric over plotting positions <span class="math inline">\(\mathcal{P}\)</span> and the <span class="math inline">\(B\)</span> bootstrap samples.</li>
</ul>
</div>
</section>
<section id="metric-based-adjustment-1" class="slide level2">
<h2>Metric-based adjustment</h2>

<img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="bayesian-predictive-distribution" class="slide level2">
<h2>Bayesian predictive distribution</h2>
<div style="font-size: 85%;">
<p><span class="citation" data-cites="Northrop.Attalides.Jonathan:2017">Northrop, Attalides, and Jonathan (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span> propose a Bayesian method based on leave-one-out cross validation with a binomial-generalized Pareto (BGP) model and a single validation threshold <span class="math inline">\(v &gt; u_k\)</span> above which we assess the model performance.</p>
<p>The measure of goodness-of-fit proposed is an estimate of the negated Kullback–Leibler divergence, <span class="math display">\[\begin{align*}
\widehat{T}_v(u_j) = \sum_{i=1}^n \log\widehat{f}_v(x_r \mid \boldsymbol{x}_{-r}, u_j).
\end{align*}\]</span> The selected threshold is the one maximizing this diagnostic.</p>
<p>Can use Bayesian model averaging to account for the uncertainty originating from threshold selection.</p>
</div>
</section>
<section id="bayesian-measures" class="slide level2">
<h2>Bayesian measures</h2>

<img data-src="figures/fig-surprise-Bayesian.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"></section>
<section id="semiparametric-methods" class="slide level2">
<h2>Semiparametric methods</h2>
<p>Threshold selection is typically based on minimizing an asymptotic mean squared error for Hill’s estimator.</p>
<p>These procedures either</p>
<ul>
<li>estimate higher-order parameters that appear in the asymptotic mean squared error formula, or</li>
<li>fix them (e.g., setting <span class="math inline">\(\rho=-1\)</span>), or</li>
<li>use bootstrap schemes to circumvent having to do so.</li>
</ul>
</section>
<section id="bootstrap-methods" class="slide level2">
<h2>Bootstrap methods</h2>
<div style="font-size: 70%;">
<p>Generalization of the method proposed in <span class="citation" data-cites="Hall:1990">Hall (<a href="#/references" role="doc-biblioref" onclick="">1990</a>)</span></p>
<ul>
<li>estimate the shape parameter using Hill’s estimator with the <span class="math inline">\(n_0\)</span> largest order statistics;</li>
<li>perform a bootstrap loop (<span class="math inline">\(B\)</span> replications): resample <span class="math inline">\(m &lt; n\)</span> observations with replacement and compute Hill’s estimator for the <span class="math inline">\(n_m=1, \ldots, m\)</span> largest order statistics. Denote the shifted estimates for the <span class="math inline">\(b\)</span>th bootstrap replicate <span class="math inline">\(d^{(b)}_{n_m}=(\widehat{H}^{(b)}_{m, n_m} - \widehat{H}_{n, n_0})^2\)</span>;</li>
<li>average <span class="math inline">\(d^{(b)}_{n_m}\)</span> over all bootstrap replications for each <span class="math inline">\(n_m=1, \ldots, m\)</span> and select <span class="math inline">\(\widehat{n}_m\)</span> that minimizes the mean squared error.</li>
<li>for given <span class="math inline">\(\rho\)</span>, compute the optimal number of exceedances for the full sample <span class="math inline">\(\widehat{n}_u = \widehat{n}_m(n/m)^{-2\rho/(1-2\rho)}.\)</span></li>
</ul>
<p>The method is sensitive to the choice of <span class="math inline">\(n_0\)</span> and <span class="math inline">\(m=\mathrm{o}(n)\)</span>, which is left to the user</p>
</div>
</section>
<section id="semiparametric-methods-1" class="slide level2">
<h2>Semiparametric methods</h2>
<p>Other proposals include</p>
<ul>
<li><span class="citation" data-cites="Goegebeur.Beirlant.deWet:2008">Goegebeur, Beirlant, and Wet (<a href="#/references" role="doc-biblioref" onclick="">2008</a>)</span>,</li>
<li><span class="citation" data-cites="Bladt:2020">Bladt, Albrecher, and Beirlant (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span> and</li>
<li><span class="citation" data-cites="Schneider:2021">Schneider, Krajina, and Krivobokova (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span></li>
</ul>
<p>They relate the bias and MSE of Hill estimator with other estimators for <span class="math inline">\(\xi&gt;0\)</span>, and use these to minimize the mean squared error under the assumption <span class="math inline">\(\rho=-1.\)</span></p>
</section>
<section id="random-block-maxima" class="slide level2">
<h2>Random block maxima</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ZuKoSt-choosing_threshold_files/figure-revealjs/unnamed-chunk-12-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div style="font-size: 90%;">
<p><span class="citation" data-cites="Wager:2014">Wager (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> propose an alternative estimator (random block maxima) based on <span class="math inline">\(U\)</span>-statistics, whose sample paths are <span class="math inline">\(\mathcal{C}^{\infty}\)</span> as a function of <span class="math inline">\(n_u.\)</span></p>
<p>Approximating the bias using the derivative of the sample path (which is its expected value up to scaling) leads to an empirical minimization of the MSE.</p>
</div>
</div></div>
</section></section>
<section>
<section id="simulation-results" class="title-slide slide level1 white center" data-background-color="#002855">
<h1>Simulation results</h1>

</section>
<section id="setting" class="slide level2">
<h2>Setting</h2>
<div style="font-size: 70%;">
<p>We generate <span class="math inline">\(n=2000\)</span> observations from 16 distributions with varying shape parameters.</p>
<p>We set the fixed grid <span class="math inline">\(\mathcal{U}\)</span> at the empirical <span class="math inline">\(\{0.8, 0.81, \ldots, 0.98\}\)</span> quantiles.</p>
</div>

<img data-src="figures/penultimate_shapes.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="how-to-benchmark-methods" class="slide level2">
<h2>How to benchmark methods?</h2>
<p>What makes a threshold procedure good? In practice, we care about the extrapolation, often</p>
<ul>
<li>a high quantile (return level), or</li>
<li>a probability of exceedance.</li>
</ul>
<p>Benchmarking the method based on proximity with the asymptotic shape parameter is <strong>not</strong> a good point of reference.</p>
</section>
<section id="parametric-methods" class="slide level2">
<h2>Parametric methods</h2>

<img data-src="figures/fig-simulation1-meanpercentile.png" class="quarto-figure quarto-figure-center r-stretch" style="width:100.0%"></section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<div style="font-size: 70%;">
<ul>
<li>The oracle returns thresholds that are on average between the 0.87 and the 0.9 quantiles, but is quite variable.</li>
<li>Many of the automated procedures return the lowest possible threshold, with the mode for most scenarios being the 0.8 quantile. Exceptions are the procedures of <span class="citation" data-cites="Thompson:2009">Thompson et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span>, <span class="citation" data-cites="Northrop.Coleman:2014">Northrop and Coleman (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> and <span class="citation" data-cites="SilvaLomba.FragaAlves:2020">Silva Lomba and Fraga Alves (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span>, which have higher modes.</li>
<li>Application of ForwardStop leads to thresholds that are much lower, and is therefore not recommended.</li>
<li>The coefficient of variation method of <span class="citation" data-cites="Castillo.Padilla:2016">Castillo and Padilla (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> nearly always selects the lowest possible threshold, across all simulation scenarios considered. It also fails often, and cannot be recommended.</li>
</ul>
</div>
</section>
<section id="comments-1" class="slide level2">
<h2>Comments</h2>
<div style="font-size: 70%;">
<ul>
<li>The methods of <span class="citation" data-cites="Thompson:2009">Thompson et al. (<a href="#/references" role="doc-biblioref" onclick="">2009</a>)</span>, <span class="citation" data-cites="Suveges.Davison:2010">Süveges and Davison (<a href="#/references" role="doc-biblioref" onclick="">2010</a>)</span>, <span class="citation" data-cites="Northrop.Attalides.Jonathan:2017">Northrop, Attalides, and Jonathan (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span>, <span class="citation" data-cites="SilvaLomba.FragaAlves:2020">Silva Lomba and Fraga Alves (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span> and <span class="citation" data-cites="Kiran.Srinivas:2021">Kiran and Srinivas (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> lead to much less agreement and a greater variability of selected quantile levels for the thresholds.</li>
<li><span class="citation" data-cites="Wadsworth:2016">Wadsworth (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> sequential testing fails 17% of the time, even after reducing the number of thresholds considered and with sample sizes of 1000 observations. It performs best with heavy tailed distributions, and is generally competitive.</li>
<li>The procedures of <span class="citation" data-cites="Varty.Tawn:2021">Varty et al. (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> and <span class="citation" data-cites="Murphy.Tawn.Varty:2024">Murphy, Tawn, and Varty (<a href="#/references" role="doc-biblioref" onclick="">2025</a>)</span> perform well relative to the oracle (except for distribution <span class="math inline">\(j\)</span>), but tend to select very low thresholds. Their relative performance however varies much.</li>
<li>The Bayesian model averaging method of <span class="citation" data-cites="Northrop.Attalides.Jonathan:2017">Northrop, Attalides, and Jonathan (<a href="#/references" role="doc-biblioref" onclick="">2017</a>)</span> is competitive in all scenarios.</li>
</ul>
</div>
</section>
<section id="semiparametric-methods-shape-parameters" class="slide level2">
<h2>Semiparametric methods (shape parameters)</h2>

<img data-src="figures/Fig-shape_2K_semipar_none.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="semiparametric-methods-number-of-exceedances" class="slide level2">
<h2>Semiparametric methods (number of exceedances)</h2>

<img data-src="figures/Fig-orderstat_2K_semipar_none.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="comments-2" class="slide level2">
<h2>Comments</h2>
<div style="font-size: 70%;">
<ul>
<li>The Hill estimator struggles with distributions for which <span class="math inline">\(\xi\)</span> is low, but excels for very heavy tailed distributions. The exponential estimator and the random block maxima are more variable for the latter case;</li>
<li>The <span class="citation" data-cites="Beirlant.Vynckier.Teugels:1996b">Beirlant, Vynckier, and Teugels (<a href="#/references" role="doc-biblioref" onclick="">1996</a>)</span> procedure is extremely variable, both for the selection of <span class="math inline">\(n_u\)</span> and for the estimation of <span class="math inline">\(\xi\)</span>. It often fails to fit.</li>
<li>The methods of <span class="citation" data-cites="Hall.Welsh:1985">Hall and Welsh (<a href="#/references" role="doc-biblioref" onclick="">1985</a>)</span> and <span class="citation" data-cites="Caeiro.Gomes:2014">Caeiro and Gomes (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> behave erratically with small shape parameters, giving shape parameter estimates that show strong upward bias. They retain more than 15% of the data for inference, with a wide range of values of order statistics <span class="math inline">\(n_u\)</span>.</li>
<li>The proposals of <span class="citation" data-cites="Bladt:2020">Bladt, Albrecher, and Beirlant (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span> and <span class="citation" data-cites="Schneider:2021">Schneider, Krajina, and Krivobokova (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> work very well in the heavy-tailed case.</li>
</ul>
</div>
</section>
<section id="comments-3" class="slide level2">
<h2>Comments</h2>
<div style="font-size: 70%;">
<ul>
<li>The minimization of AMSE of <span class="citation" data-cites="Caeiro.Gomes:2016">Caeiro and Gomes (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> and <span class="citation" data-cites="Gomes.Figueiredo.Neves:2012">Gomes, Figueiredo, and Neves (<a href="#/references" role="doc-biblioref" onclick="">2012</a>)</span> display low relative root mean squared error for quantile estimation, consistently across all scenarios, although the methods based on minimization of the asymptotic mean squared error can break down catastrophically.</li>
<li>The method with the lowest relative bias for quantiles is <span class="citation" data-cites="Guillou.Hall:2001">Guillou and Hall (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span>, the lower mean squared errors are given by the <span class="citation" data-cites="Danielsson:2019">Danielsson et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span> minimization of the Kolomogorov–Smirnov distance (for <span class="math inline">\(\xi &lt; 0.25\)</span>) and <span class="citation" data-cites="Bladt:2020">Bladt, Albrecher, and Beirlant (<a href="#/references" role="doc-biblioref" onclick="">2020</a>)</span> (<span class="math inline">\(\xi \geq 0.5\)</span>);</li>
<li><span class="citation" data-cites="Drees.Kaufmann:1998">Drees and Kaufmann (<a href="#/references" role="doc-biblioref" onclick="">1998</a>)</span> fails to return valid values for <span class="math inline">\(n_u\)</span> in around 80% of cases. When it works, it leads to small values of <span class="math inline">\(n_u\)</span>, and to shape estimates that are below average and too variable.</li>
</ul>
</div>
</section>
<section id="comments-4" class="slide level2">
<h2>Comments</h2>
<div style="font-size: 70%;">
<ul>
<li>The <span class="citation" data-cites="Dupuis.Victoria-Feser:2003">Dupuis and Victoria-Feser (<a href="#/references" role="doc-biblioref" onclick="">2003</a>)</span> estimator leads to very small number of exceedances, and thus variable and negatively-biased shape estimates, but performs best for quantile estimation for low shape parameter.</li>
<li>The sampling distributions of the shape parameters for the methods of <span class="citation" data-cites="Reiss.Thomas:2007">Reiss and Thomas (<a href="#/references" role="doc-biblioref" onclick="">2007</a>)</span> are left-skewed.</li>
</ul>
</div>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<div style="font-size: 85%;">
<ul>
<li>There is no clear winner, but some methods are clearly suboptimal.</li>
<li>Estimation of second order parameters is difficult and typically far too noisy to be useful. More stable methods are obtained by fixing <span class="math inline">\(\rho\)</span> to a negative value, or bypassing its estimation completely, as in <span class="citation" data-cites="Wager:2014">Wager (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span>.</li>
<li>Many algorithms consider all potential choice of threshold, irrespective of the minimum number of exceedances needed for reliable estimation, or of the fact only the largest observations should be selected.</li>
</ul>
</div>
</section>
<section id="conclusions-1" class="slide level2">
<h2>Conclusions</h2>
<p>Are we barking up the wrong tree?</p>
<ul>
<li>Is the problem well-formulated? there is no “correct” threshold.</li>
<li>Threshold selection has often a tremendous impact on conclusion, so perhaps it would make more sense to fit sub-asymptotic models to much more data, while avoiding if possible contamination.</li>
<li>Weighting and model averaging to account for model uncertainty is promising, but validation criteria have huge impacts.</li>
</ul>
</section>
<section id="question-period" class="slide level2">
<h2>Question period</h2>
<div class="center">
<p>Thank you for your attention.</p>
<p>This presentation is based on joint work with Anthony Davison, with valuable insights from Sonia Alouini.</p>
<p>18 methods are implemented in package <code>mev</code> (version 2.1).</p>
<p>Thanks to NSERC for funding.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/NSERC.png" class="quarto-figure quarto-figure-center" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div style="font-size: 90%;">
<p>Slides at <a href="https://lbelzile.github.io/ZuKoSt-2025-choosing-threshold"><code>lbelzile.github.io/ZuKoSt-2025-choosing-threshold</code></a></p>
</div>
</section>
<section id="distributions" class="slide level2">
<h2>Distributions</h2>
<div style="font-size: 50%;">
<ol type="1">
<li>gamma with shape <span class="math inline">\(2\)</span> and scale <span class="math inline">\(1\)</span>;</li>
<li>standard lognormal;</li>
<li>Weibull with scale <span class="math inline">\(1\)</span> and shape <span class="math inline">\(0.75\)</span>;</li>
<li>Weibull with scale <span class="math inline">\(1\)</span> and shape <span class="math inline">\(1.25\)</span>;</li>
<li>piecewise generalized Pareto with shape <span class="math inline">\(0.25\)</span> up to <span class="math inline">\(u=1.25\)</span> and <span class="math inline">\(-0.25\)</span> above</li>
<li>standard exponential (<span class="math inline">\(\xi=0\)</span>)</li>
<li>generalized Pareto with shape <span class="math inline">\(\xi=0.15\)</span></li>
<li>generalized Pareto with shape <span class="math inline">\(\xi=-0.15\)</span></li>
<li>Student-<span class="math inline">\(t\)</span> with 6 degrees of freedom <span class="math inline">\((\xi=1/6\)</span>) truncated on <span class="math inline">\(\mathbb{R}^{+}\)</span>;</li>
<li>standard Fréchet with shape <span class="math inline">\(\xi=0.5\)</span>;</li>
<li>standard Cauchy (<span class="math inline">\(\xi=1\)</span>) truncated on <span class="math inline">\(\mathbb{R}^{+}\)</span>;</li>
<li>loggamma with density function <span class="math inline">\(\log(x) x^{-2}\)</span> for <span class="math inline">\(x \geq 1\)</span> (<span class="math inline">\(\xi=1\)</span>);</li>
<li>Burr with survival function <span class="math inline">\((1+x^{2})^{-1}\)</span> for <span class="math inline">\(x&gt;0\)</span> (<span class="math inline">\(\xi=0.5\)</span>);</li>
<li>piecewise generalized Pareto <span class="citation" data-cites="Northrop.Coleman:2014">(<a href="#/references" role="doc-biblioref" onclick="">Northrop and Coleman 2014</a>)</span> with shape <span class="math inline">\(-0.5\)</span> up to the <span class="math inline">\(0.9\)</span> quantile and <span class="math inline">\(0.25\)</span> above;</li>
<li>third extended generalized Pareto model of <span class="citation" data-cites="Papastathopoulos.Tawn:2013">Papastathopoulos and Tawn (<a href="#/references" role="doc-biblioref" onclick="">2013</a>)</span> (power model) with <span class="math inline">\(\xi=-0.2\)</span>, unit scale and <span class="math inline">\(\kappa = 0.25\)</span>;</li>
<li>exponential tilting extended generalized Pareto model with shape <span class="math inline">\(\xi =0.2\)</span> and <span class="math inline">\(\kappa=0.1\)</span></li>
</ol>
</div>
<!-- ## Parametric methods -->
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bader.Yan.Zhang:2018" class="csl-entry" role="listitem">
Bader, Brian, Jun Yan, and Xuebin Zhang. 2018. <span>“Automated Threshold Selection for Extreme Value Analysis via Ordered Goodness-of-Fit Tests with Adjustment for False Discovery Rate.”</span> <em>The Annals of Applied Statistics</em> 12 (1): 310–29. <a href="https://doi.org/10.1214/17-aoas1092">https://doi.org/10.1214/17-aoas1092</a>.
</div>
<div id="ref-Beirlant.Vynckier.Teugels:1996b" class="csl-entry" role="listitem">
Beirlant, Jan, Petra Vynckier, and Josef L. Teugels. 1996. <span>“Excess Functions and Estimation of the Extreme-Value Index.”</span> <em>Bernoulli</em> 2 (4): 293–318.
</div>
<div id="ref-Bladt:2020" class="csl-entry" role="listitem">
Bladt, Martin, Hansjörg Albrecher, and Jan Beirlant. 2020. <span>“Threshold Selection and Trimming in Extremes.”</span> <em>Extremes</em> 23 (4): 629–65. <a href="https://doi.org/10.1007/s10687-020-00385-0">https://doi.org/10.1007/s10687-020-00385-0</a>.
</div>
<div id="ref-Caeiro.Gomes:2014" class="csl-entry" role="listitem">
Caeiro, Frederico, and Ivette Gomes. 2014. <span>“On the Bootstrap Methodology for the Estimation of the Tail Sample Fraction.”</span> In <em>Proceedings of COMPSTAT 2014</em>, 545–52.
</div>
<div id="ref-Caeiro.Gomes:2016" class="csl-entry" role="listitem">
Caeiro, Frederico, and M. Ivette Gomes. 2016. <span>“Threshold Selection in Extreme Value Analysis.”</span> In <em>Extreme Value Modeling and Risk Analysis: Methods and Applications</em>, edited by Dipak K. Dey and Jun Yan, 69–86. Boca Raton, FL: CRC Press. <a href="https://doi.org/10.1201/b19721">https://doi.org/10.1201/b19721</a>.
</div>
<div id="ref-Castillo.Padilla:2016" class="csl-entry" role="listitem">
Castillo, Joan del, and Maria Padilla. 2016. <span>“Modelling Extreme Values by the Residual Coefficient of Variation.”</span> <em>Statistics and Operations Research Transactions</em> 40 (2): 303–20. <a href="https://doi.org/10.2436/20.8080.02.45">https://doi.org/10.2436/20.8080.02.45</a>.
</div>
<div id="ref-Choulakian.Stephens:2001" class="csl-entry" role="listitem">
Choulakian, Vartan, and Michael A Stephens. 2001. <span>“Goodness-of-Fit Tests for the Generalized <span>P</span>areto Distribution.”</span> <em>Technometrics</em> 43 (4): 478–84. <a href="https://doi.org/10.1198/00401700152672573">https://doi.org/10.1198/00401700152672573</a>.
</div>
<div id="ref-Collings:2025" class="csl-entry" role="listitem">
Collings, T. P., C. J. R. Murphy-Barltrop, C. Murphy, I. D. Haigh, P. D. Bates, and N. D. Quinn. 2025. <span>“Automated Tail-Informed Threshold Selection for Extreme Coastal Sea Levels.”</span> <em>Natural Hazards and Earth System Sciences</em> 25 (11): 4545–62. <a href="https://doi.org/10.5194/nhess-25-4545-2025">https://doi.org/10.5194/nhess-25-4545-2025</a>.
</div>
<div id="ref-Danielsson:2019" class="csl-entry" role="listitem">
Danielsson, Jon, Lerby Ergun, Casper G. de Vries, and Laurens de Haan. 2019. <span>“Tail Index Estimation: Quantile-Driven Threshold Selection.”</span> <a href="https://doi.org/10.34989/swp-2019-28">https://doi.org/10.34989/swp-2019-28</a>.
</div>
<div id="ref-Davison.Smith:1990" class="csl-entry" role="listitem">
Davison, Anthony C., and Richard L. Smith. 1990. <span>“Models for Exceedances over High Thresholds (with Discussion).”</span> <em>Journal of the Royal Statistical Society. Series B. (Methodological)</em> 52 (3): 393–442. <a href="https://doi.org/10.1111/j.2517-6161.1990.tb01796.x">https://doi.org/10.1111/j.2517-6161.1990.tb01796.x</a>.
</div>
<div id="ref-deHaan.Ferreira:2006" class="csl-entry" role="listitem">
de Haan, L., and A. Ferreira. 2006. <em>Extreme Value Theory: An Introduction</em>. New York: Springer. <a href="https://doi.org/10.1007/0-387-34471-3">https://doi.org/10.1007/0-387-34471-3</a>.
</div>
<div id="ref-Drees.Kaufmann:1998" class="csl-entry" role="listitem">
Drees, Holger, and Edgar Kaufmann. 1998. <span>“Selecting the Optimal Sample Fraction in Univariate Extreme Value Estimation.”</span> <em>Stochastic Processes and Their Applications</em> 75 (2): 149–72. <a href="https://doi.org/10.1016/s0304-4149(98)00017-9">https://doi.org/10.1016/s0304-4149(98)00017-9</a>.
</div>
<div id="ref-Dupuis.Victoria-Feser:2003" class="csl-entry" role="listitem">
Dupuis, Debbie J., and Maria-Pia Victoria-Feser. 2003. <span>“A Prediction Error Criterion for Choosing the Lower Quantile in <span>P</span>areto Index Estimation.”</span> University of Geneva. <a href="https://archive-ouverte.unige.ch/unige:5789">https://archive-ouverte.unige.ch/unige:5789</a>.
</div>
<div id="ref-Gamet.Jalbert:2022" class="csl-entry" role="listitem">
Gamet, Philémon, and Jonathan Jalbert. 2022. <span>“A Flexible Extended Generalized Pareto Distribution for Tail Estimation.”</span> <em>Environmetrics</em> 33 (6). <a href="https://doi.org/10.1002/env.2744">https://doi.org/10.1002/env.2744</a>.
</div>
<div id="ref-Goegebeur.Beirlant.deWet:2008" class="csl-entry" role="listitem">
Goegebeur, Yuri, Jan Beirlant, and Tertius de Wet. 2008. <span>“Linking <span>P</span>areto-Tail Kernel Goodness-of-Fit Statistics with Tail Index at Optimal Threshold and Second Order Estimation.”</span> <em>REVSTAT-Statistical Journal</em> 6 (1): 51–69. <a href="https://doi.org/10.57805/revstat.v6i1.57">https://doi.org/10.57805/revstat.v6i1.57</a>.
</div>
<div id="ref-Gomes.Figueiredo.Neves:2012" class="csl-entry" role="listitem">
Gomes, M. Ivette, Fernanda Figueiredo, and M. Manuela Neves. 2012. <span>“Adaptive Estimation of Heavy Right Tails: Resampling-Based Methods in Action.”</span> <em>Extremes</em> 15 (4): 463–89. <a href="https://doi.org/10.1007/s10687-011-0146-6">https://doi.org/10.1007/s10687-011-0146-6</a>.
</div>
<div id="ref-Gomes.Oliveira:2001" class="csl-entry" role="listitem">
Gomes, M. Ivette, and Orlando Oliveira. 2001. <span>“The Bootstrap Methodology in Statistics of Extremes—Choice of the Optimal Sample Fraction.”</span> <em>Extremes</em> 4 (4): 331–58. <a href="https://doi.org/10.1023/a:1016592028871">https://doi.org/10.1023/a:1016592028871</a>.
</div>
<div id="ref-Grimshaw:1993" class="csl-entry" role="listitem">
Grimshaw, Scott D. 1993. <span>“Computing Maximum Likelihood Estimates for the Generalized <span>P</span>areto Distribution.”</span> <em>Technometrics</em> 35 (2): 185–91. <a href="https://doi.org/10.1080/00401706.1993.10485040">https://doi.org/10.1080/00401706.1993.10485040</a>.
</div>
<div id="ref-Guillou.Hall:2001" class="csl-entry" role="listitem">
Guillou, Armelle, and Peter Hall. 2001. <span>“A Diagnostic for Selecting the Threshold in Extreme Value Analysis.”</span> <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 63 (2): 293–305. <a href="https://doi.org/10.1111/1467-9868.00286">https://doi.org/10.1111/1467-9868.00286</a>.
</div>
<div id="ref-Hall:1990" class="csl-entry" role="listitem">
Hall, Peter. 1990. <span>“Using the Bootstrap to Estimate Mean Squared Error and Select Smoothing Parameter in Nonparametric Problems.”</span> <em>Journal of Multivariate Analysis</em> 32 (2): 177–203. <a href="https://doi.org/10.1016/0047-259x(90)90080-2">https://doi.org/10.1016/0047-259x(90)90080-2</a>.
</div>
<div id="ref-Hall.Welsh:1985" class="csl-entry" role="listitem">
Hall, Peter, and A. H. Welsh. 1985. <span>“Adaptive Estimates of Parameters of Regular Variation.”</span> <em>The Annals of Statistics</em> 13 (1): 331–41. <a href="https://doi.org/10.1214/aos/1176346596">https://doi.org/10.1214/aos/1176346596</a>.
</div>
<div id="ref-Hill:1975" class="csl-entry" role="listitem">
Hill, B. M. 1975. <span>“A Simple General Approach to Inference about the Tail of a Distribution.”</span> <em>Annals of Statistics</em> 3: 1163–74. <a href="https://doi.org/10.1214/aos/1176343247">https://doi.org/10.1214/aos/1176343247</a>.
</div>
<div id="ref-Hu.Scarrott:2018" class="csl-entry" role="listitem">
Hu, Yang, and Carl Scarrott. 2018. <span>“<code>evmix</code>: An <span>R</span> Package for Extreme Value Mixture Modeling, Threshold Estimation and Boundary Corrected Kernel Density Estimation.”</span> <em>Journal of Statistical Software</em> 84 (5): 1–27. <a href="https://doi.org/10.18637/jss.v084.i05">https://doi.org/10.18637/jss.v084.i05</a>.
</div>
<div id="ref-Kiran.Srinivas:2021" class="csl-entry" role="listitem">
Kiran, Kezhkepurath Gangadhara, and Venkata V. Srinivas. 2021. <span>“A <span>M</span>ahalanobis Distance-Based Automatic Threshold Selection Method for Peaks over Threshold Model.”</span> <em>Water Resources Research</em> 57 (e2020WR027534). <a href="https://doi.org/10.1029/2020wr027534">https://doi.org/10.1029/2020wr027534</a>.
</div>
<div id="ref-Langousis:2016" class="csl-entry" role="listitem">
Langousis, Andreas, Antonios Mamalakis, Michelangelo Puliga, and Roberto Deidda. 2016. <span>“Threshold Detection for the Generalized <span>P</span>areto Distribution: Review of Representative Methods and Application to the <span>NOAA</span> <span>NCDC</span> Daily Rainfall Database.”</span> <em>Water Resources Research</em> 52 (4): 2659–81. https://doi.org/<a href="https://doi.org/10.1002/2015WR018502">https://doi.org/10.1002/2015WR018502</a>.
</div>
<div id="ref-Marani.Zanetti:2015" class="csl-entry" role="listitem">
Marani, Marco, and Stefano Zanetti. 2015. <span>“Long-Term Oscillations in Rainfall Extremes in a 268 Year Daily Time Series.”</span> <em>Water Resources Research</em> 51 (1): 639–47. <a href="https://doi.org/10.1002/2014wr015885">https://doi.org/10.1002/2014wr015885</a>.
</div>
<div id="ref-Murphy.Tawn.Varty:2024" class="csl-entry" role="listitem">
Murphy, Conor, Jonathan A. Tawn, and Zak Varty. 2025. <span>“Automated Threshold Selection and Associated Inference Uncertainty for Univariate Extremes.”</span> <em>Technometrics</em> 67 (2): 215–24. <a href="https://doi.org/10.1080/00401706.2024.2421744">https://doi.org/10.1080/00401706.2024.2421744</a>.
</div>
<div id="ref-doNascimento.Gamerman.Lopes:2012" class="csl-entry" role="listitem">
Nascimento, Fernando Ferraz do, Dani Gamerman, and Hedibert Freitas Lopes. 2012. <span>“A Semiparametric <span>B</span>ayesian Approach to Extreme Value Estimation.”</span> <em>Statistics and Computing</em> 22 (2): 661–75. <a href="https://doi.org/10.1007/s11222-011-9270-z">https://doi.org/10.1007/s11222-011-9270-z</a>.
</div>
<div id="ref-Naveau:2025" class="csl-entry" role="listitem">
Naveau, Philippe. 2025. <span>“Jointly Modeling Bulk and Tails.”</span> In <em>Handbook of Statistics of Extremes</em>, edited by M. de Carvalho, R. Huser, P. Naveau, and B. J. and Reich, to appear. Boca Raton: Chapman &amp; Hall/CRC.
</div>
<div id="ref-Naveau:2016" class="csl-entry" role="listitem">
Naveau, Philippe, Raphael Huser, Pierre Ribereau, and Alexis Hannart. 2016. <span>“Modeling Jointly Low, Moderate, and Heavy Rainfall Intensities Without a Threshold Selection.”</span> <em>Water Resources Research</em> 52 (4): 2753–69. https://doi.org/<a href="https://doi.org/10.1002/2015WR018552">https://doi.org/10.1002/2015WR018552</a>.
</div>
<div id="ref-Northrop.Attalides.Jonathan:2017" class="csl-entry" role="listitem">
Northrop, Paul J., Nicolas Attalides, and Philip Jonathan. 2017. <span>“Cross-Validatory Extreme Value Threshold Selection and Uncertainty with Application to Ocean Storm Severity.”</span> <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 66 (1): 93–120. https://doi.org/<a href="https://doi.org/10.1111/rssc.12159">https://doi.org/10.1111/rssc.12159</a>.
</div>
<div id="ref-Northrop.Coleman:2014" class="csl-entry" role="listitem">
Northrop, Paul J., and Claire L. Coleman. 2014. <span>“Improved Threshold Diagnostic Plots for Extreme Value Analyses.”</span> <em>Extremes</em> 17 (2): 289–303. <a href="https://doi.org/10.1007/s10687-014-0183-z">https://doi.org/10.1007/s10687-014-0183-z</a>.
</div>
<div id="ref-Papastathopoulos.Tawn:2013" class="csl-entry" role="listitem">
Papastathopoulos, Ioannis, and Jonathan A. Tawn. 2013. <span>“Extended Generalised <span>P</span>areto Models for Tail Estimation.”</span> <em>Journal of Statistical Planning and Inference</em> 143 (1): 131–43. <a href="https://doi.org/10.1016/j.jspi.2012.07.001">https://doi.org/10.1016/j.jspi.2012.07.001</a>.
</div>
<div id="ref-Pickands:1975" class="csl-entry" role="listitem">
Pickands, James. 1975. <span>“Statistical Inference Using Extreme Order Statistics.”</span> <em>The Annals of Statistics</em> 3: 119–31. <a href="https://doi.org/10.1214/aos/1176343003">https://doi.org/10.1214/aos/1176343003</a>.
</div>
<div id="ref-Reiss.Thomas:2007" class="csl-entry" role="listitem">
Reiss, R. D., and M. Thomas. 2007. <em>Statistical Analysis of Extreme Values: With Applications to Insurance, Finance, Hydrology and Other Fields</em>. Basel: Springer Birkh<span>ä</span>user. <a href="https://doi.org/10.1007/978-3-7643-7399-3">https://doi.org/10.1007/978-3-7643-7399-3</a>.
</div>
<div id="ref-Scarrott.MacDonald:2012" class="csl-entry" role="listitem">
Scarrott, Carl J., and Anna Elizabeth MacDonald. 2012. <span>“A Review of Extreme-Value Threshold Estimation and Uncertainty Quantification.”</span> <em>REVSTAT – Statistical Journal</em> 10 (1): 33–60. <a href="https://doi.org/10.57805/revstat.v10i1.110">https://doi.org/10.57805/revstat.v10i1.110</a>.
</div>
<div id="ref-Schneider:2021" class="csl-entry" role="listitem">
Schneider, Laura Fee, Andrea Krajina, and Tatyana Krivobokova. 2021. <span>“Threshold Selection in Univariate Extreme Value Analysis.”</span> <em>Extremes</em> 24 (4): 881–913. <a href="https://doi.org/10.1007/s10687-021-00405-7">https://doi.org/10.1007/s10687-021-00405-7</a>.
</div>
<div id="ref-SilvaLomba.FragaAlves:2020" class="csl-entry" role="listitem">
Silva Lomba, Jessica, and Maria Isabel Fraga Alves. 2020. <span>“<span class="math inline">\(L\)</span>-Moments for Automatic Threshold Selection in Extreme Value Analysis.”</span> <em>Stochastic Environmental Research and Risk Assessment</em> 34 (3): 465–91. <a href="https://doi.org/10.1007/s00477-020-01789-x">https://doi.org/10.1007/s00477-020-01789-x</a>.
</div>
<div id="ref-smith_1987" class="csl-entry" role="listitem">
Smith, Richard L. 1987. <span>“Approximations in Extreme Value Theory.”</span> Department of Statistics; Operations Research, University of North Carolina. <a href="https://lbelzile.bitbucket.io/papers/Smith-1987-Approximations\%5Fin\%5Fextreme\%5Fvalue\%5Ftheory.pdf">https://lbelzile.bitbucket.io/papers/Smith-1987-Approximations\%5Fin\%5Fextreme\%5Fvalue\%5Ftheory.pdf</a>.
</div>
<div id="ref-Solari:2017" class="csl-entry" role="listitem">
Solari, Sebastián, Marta Egüen, Marı́a José Polo, and Miguel A. Losada. 2017. <span>“Peaks over Threshold (<span>POT</span>): A Methodology for Automatic Threshold Estimation Using Goodness of Fit <span class="math inline">\(p\)</span>-Value.”</span> <em>Water Resources Research</em> 53 (4): 2833–49. <a href="https://doi.org/10.1002/2016wr019426">https://doi.org/10.1002/2016wr019426</a>.
</div>
<div id="ref-Suveges.Davison:2010" class="csl-entry" role="listitem">
Süveges, Mária, and Anthony C. Davison. 2010. <span>“Model Misspecification in Peaks over Threshold Analysis.”</span> <em>Ann. Appl. Stat.</em> 4 (1): 203–21. <a href="https://doi.org/10.1214/09-aoas292">https://doi.org/10.1214/09-aoas292</a>.
</div>
<div id="ref-Thompson:2009" class="csl-entry" role="listitem">
Thompson, Paul, Yuzhi Cai, Dominic Reeve, and Julian Stander. 2009. <span>“Automated Threshold Selection Methods for Extreme Wave Analysis.”</span> <em>Coastal Engineering</em> 56 (10): 1013–21. https://doi.org/<a href="https://doi.org/10.1016/j.coastaleng.2009.06.003">https://doi.org/10.1016/j.coastaleng.2009.06.003</a>.
</div>
<div id="ref-Varty.Tawn:2021" class="csl-entry" role="listitem">
Varty, Zak, Jonathan A. Tawn, Peter M. Atkinson, and Stijn Bierman. 2021. <span>“Inference for Extreme Earthquake Magnitudes Accounting for a Time-Varying Measurement Process.”</span> <a href="https://doi.org/10.48550/arXiv.2102.00884">https://doi.org/10.48550/arXiv.2102.00884</a>.
</div>
<div id="ref-Wadsworth:2016" class="csl-entry" role="listitem">
Wadsworth, J. L. 2016. <span>“Exploiting Structure of Maximum Likelihood Estimators for Extreme Value Threshold Selection.”</span> <em>Technometrics</em> 58 (1): 116–26. <a href="https://doi.org/10.1080/00401706.2014.998345">https://doi.org/10.1080/00401706.2014.998345</a>.
</div>
<div id="ref-Wager:2014" class="csl-entry" role="listitem">
Wager, Stefan. 2014. <span>“Subsampling Extremes: From Block Maxima to Smooth Tail Estimation.”</span> <em>Journal of Multivariate Analysis</em> 130: 335–53. <a href="https://doi.org/10.1016/j.jmva.2014.06.010">https://doi.org/10.1016/j.jmva.2014.06.010</a>.
</div>
<div id="ref-Weissman:1978" class="csl-entry" role="listitem">
Weissman, I. 1978. <span>“Estimation of Parameters and Large Quantiles Based on the <span class="math inline">\(k\)</span> Largest Observations.”</span> <em>Journal of the American Statistical Association</em> 73: 812–15. <a href="https://doi.org/10.1080/01621459.1978.10480104">https://doi.org/10.1080/01621459.1978.10480104</a>.
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="figures/logo_hec_montreal_bleu_web.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>